(()=>{var e={};e.id=286,e.ids=[286],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},1179:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d}),s(7338),s(9127),s(5866);var r=s(3191),a=s(8716),l=s(7922),n=s.n(l),i=s(5231),o={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>i[e]);s.d(t,o);let d=["",{children:["products",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,7338)),"/home/manojmenon/projects/rm/frontend/src/app/products/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9127)),"/home/manojmenon/projects/rm/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/manojmenon/projects/rm/frontend/src/app/products/page.tsx"],u="/products/page",h={require:s,loadChunk:()=>Promise.resolve()},p=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/products/page",pathname:"/products",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},5938:(e,t,s)=>{Promise.resolve().then(s.bind(s,7039))},7039:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var r=s(326),a=s(7577),l=s(4976),n=s(6667),i=s(6324),o=s(119),d=s(434),c=s(5047),u=s(2643),h=s(8069),p=s(104),m=s(6591);let x=[10,25,50,100],g={name:"",version:"",status:"",lifecycle:"",owner:""};function f(e){return"pending"===(e??"").toLowerCase()}function b(e){let t=(e??"").toLowerCase();return"pending"===t?"Pending":"approved"===t?"Approved":"archived"===t?"Archived":e||"—"}function y(e){let t=(e??"").toLowerCase();return"approved"===t?"approved":"archived"===t?"archived":"pending"}function v(){let{user:e}=(0,m.t)(),t=(0,l.NL)(),s=(0,c.useSearchParams)(),[u,v]=(0,a.useState)(0),[j,w]=(0,a.useState)(25),[N,_]=(0,a.useState)(""),[C,k]=(0,a.useState)(()=>s.get("status")??""),[S,M]=(0,a.useState)(()=>s.get("owner_id")??""),[L,P]=(0,a.useState)(()=>s.get("lifecycle_status")??""),[q,E]=(0,a.useState)(()=>s.get("category_1")??""),[O,F]=(0,a.useState)(()=>s.get("category_2")??""),[R,A]=(0,a.useState)(()=>s.get("category_3")??""),[T,D]=(0,a.useState)(()=>s.get("group_id")??""),[$,V]=(0,a.useState)("all"),[K,Q]=(0,a.useState)(p.e6),[I,B]=(0,a.useState)(g),[H,z]=(0,a.useState)(!1),[W,U]=(0,a.useState)("name"),[Z,G]=(0,a.useState)("asc"),[Y,J]=(0,a.useState)(null),[X,ee]=(0,a.useState)(null),[et,es]=(0,a.useState)(""),[er,ea]=(0,a.useState)(""),[el,en]=(0,a.useState)(null),[ei,eo]=(0,a.useState)(null),[ed,ec]=(0,a.useState)({}),[eu,eh]=(0,a.useState)(null),[ep,em]=(0,a.useState)(""),[ex,eg]=(0,a.useState)(""),ef=(()=>{let t=e?.role?.toLowerCase();return"admin"===t||"superadmin"===t})(),eb="all"===$?null:"custom"===$?K:(0,p.IO)($),ey=Math.min(200,Math.max(1,j)),ev=x.includes(ey)?ey:"custom",{data:ej=[]}=(0,n.a)({queryKey:["groups"],queryFn:()=>h.h.groups.list(),staleTime:6e4}),{data:ew,isLoading:eN}=(0,n.a)({queryKey:["products",{limit:ey,offset:u,status:C||void 0,owner_id:S||void 0,lifecycle_status:L||void 0,category_1:q||void 0,category_2:O||void 0,category_3:R||void 0,group_id:T||void 0,date_from:eb?.dateFrom,date_to:eb?.dateTo,sort_by:W,order:Z}],queryFn:()=>h.h.products.list({limit:ey,offset:u,...C&&{status:C},...S&&{owner_id:S},...L&&{lifecycle_status:L},...q&&{category_1:q},...O&&{category_2:O},...R&&{category_3:R},...T&&{group_id:T},...eb&&{date_from:eb.dateFrom,date_to:eb.dateTo},sort_by:W,order:Z}),staleTime:0,refetchOnMount:"always"}),e_=ew?.items??[],{data:eC=[]}=(0,n.a)({queryKey:["users"],queryFn:()=>h.h.users.list(),enabled:ef,staleTime:0}),{data:ek=[]}=(0,n.a)({queryKey:["deletion-requests"],queryFn:()=>h.h.deletionRequests.list({status:"pending"}),enabled:ef,staleTime:0}),eS=(0,a.useMemo)(()=>{let e=new Map;return ek.forEach(t=>{f(t.status)&&e.set(t.product_id,{id:t.id})}),e},[ek]),eM=e_.filter(e=>(function(e,t,s,r){let a=t?.status??e.status,l=t?.lifecycle_status??e.lifecycle_status,n=e.owner?.name??(e.owner_id?s.find(t=>t.id===e.owner_id)?.name:null)??"—";return(!r.name||!!e.name.toLowerCase().includes(r.name.toLowerCase()))&&(!r.version||!!(e.version??"").toLowerCase().includes(r.version.toLowerCase()))&&(!r.status||!!a.toLowerCase().includes(r.status.toLowerCase()))&&(!r.lifecycle||!!l.toLowerCase().includes(r.lifecycle.toLowerCase()))&&(!r.owner||!!String(n).toLowerCase().includes(r.owner.toLowerCase()))})(e,ed[e.id],eC,I)),eL=eM.filter(e=>f(e.status)||ef&&eS.has(e.id)),eP=eM.filter(e=>!f(e.status)&&(!ef||!eS.has(e.id))),eq=(0,a.useMemo)(()=>[...eL,...eP].map(e=>e.id),[eL,eP]),[eE,eO]=(0,a.useState)(12),eF=(0,i.h)({queries:eq.map((e,t)=>({queryKey:["product-versions",e],queryFn:()=>h.h.productVersions.listByProduct(e),staleTime:6e4,enabled:t<eE}))}),eR=(0,a.useMemo)(()=>eq.flatMap((e,t)=>(eF[t]?.data??[]).map(t=>({productId:e,versionId:t.id}))),[eq,eF]),[eA,eT]=(0,a.useState)(15),eD=(0,i.h)({queries:eR.map((t,s)=>{let r=e_.find(e=>e.id===t.productId),a=ef||r?.owner_id===e?.id;return{queryKey:["product-version-deps",t.versionId],queryFn:()=>h.h.productVersionDependencies.listByProductVersion(t.versionId),enabled:a&&!!t.versionId&&s<eA,staleTime:6e4}})}),e$=(0,a.useMemo)(()=>new Map(eq.map((e,t)=>[e,t+1])),[eq]),eV=(0,a.useMemo)(()=>{let e=new Set,t=new Set,s=new Map;return eq.forEach(e=>s.set(e,[])),eD.forEach((r,a)=>{let l=r.data??[],n=eR[a];if(!n)return;let i=n.productId;l.forEach(r=>{let a=r.target_product_id;if(eq.includes(i)){t.add(i);let e=e$.get(a);if(null!=e){let t=s.get(i);t.includes(e)||t.push(e)}}if(eq.includes(a)){e.add(a);let t=e$.get(i);if(null!=t){let e=s.get(a);e.includes(t)||e.push(t)}}})}),eq.forEach(e=>{s.get(e).sort((e,t)=>e-t)}),{isDependent:e,hasDependency:t,relatedSerialsByProductId:s,productIdToSerial:e$}},[eq,eR,eD,e$]),[eK,eQ]=(0,a.useState)(null),[eI,eB]=(0,a.useState)(!1),eH=["bg-white","bg-slate-50/60","bg-blue-50/40","bg-emerald-50/40","bg-amber-50/40","bg-violet-50/40"],ez=e=>eH[(e-1)%eH.length],eW=e=>{U(e),G(t=>W===e&&"asc"===t?"desc":"asc"),v(0)},eU=({label:e,sortKey:t})=>r.jsx("th",{className:"text-left px-4 py-3 font-medium text-dhl-red",children:(0,r.jsxs)("button",{type:"button",onClick:()=>eW(t),className:"flex items-center gap-1 hover:text-dhl-red/80 focus:outline-none focus:ring-2 focus:ring-dhl-red focus:ring-offset-1 rounded",children:[e,W===t&&r.jsx("span",{className:"text-xs","aria-hidden":!0,children:"asc"===Z?"↑":"↓"})]})}),eZ=(e,t)=>{V(e),"all"!==e&&("custom"===e&&t?Q(t):"custom"!==e&&Q((0,p.IO)(e)))},eG=!!C||!!S||!!L||!!q||!!O||!!R||!!T||"all"!==$||Object.values(I).some(e=>""!==e.trim()),eY=()=>{k(""),M(""),P(""),E(""),F(""),A(""),D(""),V("all"),Q((0,p.e6)()),B(g),v(0)},eJ=(e,t)=>{B(s=>({...s,[e]:t}))},eX=e=>{let s=eS.get(e)?.id;s&&h.h.deletionRequests.approve(s,{approved:!1}).then(()=>{t.invalidateQueries({queryKey:["deletion-requests"]})})},e0=(0,o.D)({mutationFn:({id:e,pending:t})=>{let s={};if(null!=t.status&&(s.status=t.status),null!=t.lifecycle_status&&(s.lifecycle_status=t.lifecycle_status),void 0!==t.owner_id){let e=t.owner_id;null===e||""===e||"none"===e?s.clear_owner=!0:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(String(e))&&(s.owner_id=String(e))}return h.h.products.update(e,s)},onSuccess:(e,s)=>{e4(),e&&s.id&&t.setQueryData(["product",s.id],e),eX(s.id),t.invalidateQueries({queryKey:["products"]})}}),e2=(0,o.D)({mutationFn:({id:e,approved:t})=>h.h.deletionRequests.approve(e,{approved:t}),onSuccess:async()=>{J(null),ee(null),ea(""),es(""),t.invalidateQueries({queryKey:["deletion-requests"]}),await t.refetchQueries({queryKey:["products"]})}}),e1=(e,t,s)=>{J(e),ee(t),es(s),ea("")},e4=()=>{eh(null),em(""),eg("")},e5=e=>{if(el!==e.id)return;let t=ed[e.id];t&&Object.keys(t).length>0&&(eh({product:{id:e.id,name:e.name,version:e.version||""},pending:{...t}}),em(""),eg(""),ec(t=>{let s={...t};return delete s[e.id],s}),en(null))},e3=e=>{if(el===e.id){let t=ed[e.id];t&&Object.keys(t).length>0&&(eh({product:{id:e.id,name:e.name,version:e.version||""},pending:{...t}}),em(""),eg(""),ec(t=>{let s={...t};return delete s[e.id],s})),en(null)}else en(e.id)},e6=e=>{en(null),ec(t=>{let s={...t};return delete s[e],s})},e8=eu&&ep.trim()===(eu.product.name||"").trim()&&ex.trim()===(eu.product.version||"").trim();return(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Products"}),r.jsx(d.default,{href:"/products/new",className:"btn-primary",children:"New product"})]}),(0,r.jsxs)("details",{className:"mb-6 rounded-xl border border-slate-200 bg-gradient-to-br from-slate-50 to-white shadow-sm overflow-hidden",open:eG,children:[(0,r.jsxs)("summary",{className:"font-semibold cursor-pointer text-slate-800 list-none flex items-center justify-between px-5 py-4 hover:bg-slate-50/80 transition-colors",children:[(0,r.jsxs)("span",{className:"flex items-center gap-2",children:[r.jsx("span",{className:"inline-flex items-center justify-center w-8 h-8 rounded-lg bg-slate-200/80 text-slate-600",children:r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:r.jsx("path",{d:"M3 6h18M7 12h10M10 18h4"})})}),"Advanced filters"]}),eG&&r.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),eY()},className:"rounded-lg px-3 py-1.5 text-sm font-medium text-slate-600 bg-slate-200/80 hover:bg-slate-300 hover:text-slate-800 transition-colors",children:"Clear filters"})]}),r.jsx("div",{className:"px-5 pb-5 pt-1 border-t border-slate-100",children:(0,r.jsxs)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 mt-4",children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Date range"}),r.jsx("select",{value:$,onChange:e=>{let t=e.target.value;eZ(t,"custom"===t?K:void 0),v(0)},className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400 w-full","aria-label":"Date range preset",children:p.Z$.map(e=>r.jsx("option",{value:e.value,children:e.label},e.value))})]}),"custom"===$&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Date from"}),r.jsx("input",{type:"date",value:K.dateFrom,onChange:e=>{Q(t=>({...t,dateFrom:e.target.value})),v(0)},className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400","aria-label":"Date from"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Date to"}),r.jsx("input",{type:"date",value:K.dateTo,onChange:e=>{Q(t=>({...t,dateTo:e.target.value})),v(0)},className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400","aria-label":"Date to"})]})]}),"all"!==$&&"custom"!==$&&(0,r.jsxs)("div",{className:"flex flex-col gap-1.5 text-sm text-slate-600 col-span-2 sm:col-span-1",children:[r.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Range"}),(0,r.jsxs)("span",{children:[eb?.dateFrom," – ",eb?.dateTo]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Status"}),(0,r.jsxs)("select",{value:C,onChange:e=>{k(e.target.value),v(0)},className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400 w-full","aria-label":"Filter by status",children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"archived",children:"Archived"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Lifecycle"}),(0,r.jsxs)("select",{value:L,onChange:e=>{P(e.target.value),v(0)},className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400 w-full","aria-label":"Filter by lifecycle",children:[r.jsx("option",{value:"",children:"All"}),r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"not_active",children:"Not active"}),r.jsx("option",{value:"suspend",children:"Suspended"}),r.jsx("option",{value:"end_of_roadmap",children:"End of roadmap"})]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Owner"}),(0,r.jsxs)("select",{value:S,onChange:e=>{M(e.target.value),v(0)},className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400 w-full","aria-label":"Filter by owner",children:[r.jsx("option",{value:"",children:"All"}),eC.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Category 1"}),r.jsx("input",{type:"text",value:q,onChange:e=>{E(e.target.value),v(0)},placeholder:"Any",className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400 w-full","aria-label":"Filter by category 1"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Category 2"}),r.jsx("input",{type:"text",value:O,onChange:e=>{F(e.target.value),v(0)},placeholder:"Any",className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400 w-full","aria-label":"Filter by category 2"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Category 3"}),r.jsx("input",{type:"text",value:R,onChange:e=>{A(e.target.value),v(0)},placeholder:"Any",className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400 w-full","aria-label":"Filter by category 3"})]}),(0,r.jsxs)("div",{className:"flex flex-col gap-1.5",children:[r.jsx("label",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide",children:"Group"}),(0,r.jsxs)("select",{value:T,onChange:e=>{D(e.target.value),v(0)},className:"rounded-lg border border-slate-200 px-3 py-2 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400 w-full","aria-label":"Filter by group",children:[r.jsx("option",{value:"",children:"All"}),ej.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.product_count,")"]},e.id))]})]})]})})]}),eN?r.jsx("p",{className:"text-gray-500",children:"Loading..."}):(0,r.jsxs)("div",{className:"rounded-xl border-2 border-dhl-red/30 bg-white shadow-sm overflow-hidden",children:[r.jsx("div",{className:"overflow-x-auto -mx-px",children:(0,r.jsxs)("table",{className:"w-full min-w-[640px]",children:[(0,r.jsxs)("thead",{className:"bg-dhl-yellow/25 border-b-2 border-dhl-red/40",children:[(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"text-left px-4 py-3 font-medium w-10",children:r.jsx("button",{type:"button",onClick:()=>z(e=>!e),className:`p-1.5 rounded transition-colors ${H?"bg-dhl-yellow text-dhl-red":"text-gray-500 hover:bg-gray-200 hover:text-gray-700"}`,"aria-label":H?"Hide table search":"Show table search",title:H?"Hide search":"Search in table",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("path",{d:"m21 21-4.35-4.35"})]})})}),r.jsx("th",{className:"text-left px-4 py-3 font-medium text-dhl-red w-12",children:"#"}),r.jsx(eU,{label:"Name",sortKey:"name"}),r.jsx(eU,{label:"Version",sortKey:"version"}),r.jsx(eU,{label:"Status",sortKey:"status"}),r.jsx(eU,{label:"Lifecycle",sortKey:"lifecycle_status"}),r.jsx(eU,{label:"Owner",sortKey:"owner_id"}),r.jsx("th",{className:"text-left px-4 py-3 font-medium w-24",children:"Action"})]}),H&&(0,r.jsxs)("tr",{className:"bg-dhl-yellow/15 border-b border-dhl-red/30",children:[r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2",children:r.jsx("input",{type:"text",value:I.name,onChange:e=>eJ("name",e.target.value),placeholder:"Search…",className:"w-full rounded border border-dhl-red/40 px-2 py-1.5 text-sm focus:ring-2 focus:ring-dhl-red focus:border-dhl-red","aria-label":"Filter by Name"})}),r.jsx("th",{className:"px-4 py-2",children:r.jsx("input",{type:"text",value:I.version,onChange:e=>eJ("version",e.target.value),placeholder:"Search…",className:"w-full rounded border border-dhl-red/40 px-2 py-1.5 text-sm focus:ring-2 focus:ring-dhl-red focus:border-dhl-red","aria-label":"Filter by Version"})}),r.jsx("th",{className:"px-4 py-2",children:r.jsx("input",{type:"text",value:I.status,onChange:e=>eJ("status",e.target.value),placeholder:"Search…",className:"w-full rounded border border-dhl-red/40 px-2 py-1.5 text-sm focus:ring-2 focus:ring-dhl-red focus:border-dhl-red","aria-label":"Filter by Status"})}),r.jsx("th",{className:"px-4 py-2",children:r.jsx("input",{type:"text",value:I.lifecycle,onChange:e=>eJ("lifecycle",e.target.value),placeholder:"Search…",className:"w-full rounded border border-slate-200 px-2 py-1.5 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400","aria-label":"Filter by Lifecycle"})}),r.jsx("th",{className:"px-4 py-2",children:r.jsx("input",{type:"text",value:I.owner,onChange:e=>eJ("owner",e.target.value),placeholder:"Search…",className:"w-full rounded border border-dhl-red/40 px-2 py-1.5 text-sm focus:ring-2 focus:ring-dhl-red focus:border-dhl-red","aria-label":"Filter by Owner"})}),r.jsx("th",{className:"px-4 py-2"})]})]}),eL.length>0&&(0,r.jsxs)("tbody",{className:"bg-amber-50/30",children:[r.jsx("tr",{children:(0,r.jsxs)("td",{colSpan:8,className:"px-4 py-2 text-sm font-semibold text-amber-800 border-b border-amber-200",children:["Pending (",eL.length,")"]})}),eL.map((t,s)=>{let a=ef?eS.get(t.id):null,l=ed[t.id],n=l?.status??t.status,i=l?.lifecycle_status??t.lifecycle_status,o=l?.owner_id!==void 0?l.owner_id??"none":t.owner_id??"none",c=el===t.id,u=!!(e?.id&&(t.owner_id===e.id||ef)),h=u&&(ei===t.id||c),p=s+1,m=eV.isDependent.has(t.id),x=eV.hasDependency.has(t.id),g=eV.relatedSerialsByProductId.get(t.id)??[];return(0,r.jsxs)("tr",{className:`group/row border-b last:border-0 ${u?"cursor-pointer hover:bg-dhl-yellow/10":"hover:bg-slate-50/50"} ${ez(p)} ${eK?.has(p)?"ring-2 ring-amber-400 ring-inset bg-amber-50/70":""} ${ei===t.id?"bg-dhl-yellow/15":""}`,onMouseLeave:()=>e5(t),onClick:()=>u&&!c&&eo(e=>e===t.id?null:t.id),children:[r.jsx("td",{className:"px-4 py-3 w-10"}),r.jsx("td",{className:"px-4 py-3 text-gray-500 tabular-nums w-12",children:p}),r.jsx("td",{className:"px-4 py-3",children:(0,r.jsxs)("span",{className:`flex items-center gap-1.5 ${m?"font-bold italic text-red-600":""}`,children:[a&&(ef?r.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),e1(t.id,a.id,t.name)},className:"text-amber-600 hover:text-amber-800 shrink-0 p-0.5 rounded focus:outline-none focus:ring-2 focus:ring-amber-500",title:"Confirm or reject deletion request","aria-label":"Confirm deletion request",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),r.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),r.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),r.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})}):r.jsx("span",{className:"text-amber-600 shrink-0",title:"Pending deletion request","aria-label":"Pending deletion request",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),r.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),r.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),r.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})),r.jsx(d.default,{href:`/products/${t.id}`,className:"font-medium text-indigo-600 hover:text-indigo-700 hover:underline focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-1 rounded",children:t.name}),m&&r.jsx("span",{className:"text-red-600 font-bold ml-0.5","aria-label":"Dependent product",children:"*"}),x&&r.jsx("span",{className:"text-blue-600 font-bold ml-0.5","aria-label":"Has dependency",children:"*"}),(m||x)&&g.length>0&&(0,r.jsxs)("sup",{className:"text-slate-500 font-normal ml-0.5 cursor-pointer rounded px-0.5 hover:bg-amber-100 hover:text-amber-800",title:"Dependency row numbers — hover or click to highlight rows",role:"button",tabIndex:0,onMouseEnter:()=>{eQ(new Set(g)),eB(!1)},onMouseLeave:()=>{eI||eQ(null)},onClick:e=>{e.preventDefault(),e.stopPropagation();let t=eK&&g.length===eK.size&&g.every(e=>eK.has(e));eI&&t?(eQ(null),eB(!1)):(eQ(new Set(g)),eB(!0))},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.target.click())},children:["(",g.join(", "),")"]})]})}),r.jsx("td",{className:"px-4 py-3",children:t.version||"—"}),r.jsx("td",{className:"px-4 py-3",children:u&&c?(0,r.jsxs)("select",{value:y(n),onChange:e=>{let s=e.target.value;ec(e=>({...e,[t.id]:{...e[t.id],status:s}}))},className:"input py-1 text-sm w-auto min-w-[100px]",disabled:e0.isPending,title:"Set product status (owner)",children:[r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"archived",children:"Archived"})]}):r.jsx("span",{className:"px-2 py-0.5 rounded text-sm bg-dhl-yellow/30 text-slate-800",children:b(n)})}),r.jsx("td",{className:"px-4 py-3",children:u&&c?(0,r.jsxs)("select",{value:i,onChange:e=>{let s=e.target.value;ec(e=>({...e,[t.id]:{...e[t.id],lifecycle_status:s}}))},className:"input py-1 text-sm w-auto min-w-[120px]",disabled:e0.isPending,title:"Set lifecycle (owner)",children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"not_active",children:"Not Active"}),r.jsx("option",{value:"suspend",children:"Suspend"}),r.jsx("option",{value:"end_of_roadmap",children:"End of roadmap"})]}):r.jsx("span",{className:(l?.lifecycle_status??t.lifecycle_status)==="active"?"text-green-600 text-sm":(l?.lifecycle_status??t.lifecycle_status)==="not_active"?"text-gray-600 text-sm":(l?.lifecycle_status??t.lifecycle_status)==="suspend"?"text-amber-600 text-sm":"text-gray-600 text-sm",children:"active"===i?"Active":"not_active"===i?"Not Active":"suspend"===i?"Suspend":"end_of_roadmap"===i?"End of roadmap":i})}),r.jsx("td",{className:"px-4 py-3",children:u&&c?r.jsx("div",{children:(0,r.jsxs)("select",{value:o,onChange:e=>{let s=e.target.value;ec(e=>({...e,[t.id]:{...e[t.id],owner_id:"none"===s?null:s}}))},className:"input py-1 text-sm w-auto min-w-[120px]",disabled:e0.isPending,title:"Set owner (owner)",children:[r.jsx("option",{value:"none",children:"No owner"}),eC.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})}):t.owner?.name??"—"}),r.jsx("td",{className:`px-4 py-3 align-middle transition-opacity ${ei===t.id||c?"opacity-100":"opacity-0 group-hover/row:opacity-100"}`,onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h&&(c?(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:()=>e3(t),className:"inline-flex items-center gap-1.5 min-h-[2rem] px-2 py-1 rounded-lg text-sm font-medium text-white bg-dhl-red hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-dhl-yellow cursor-pointer",title:"Save changes","aria-label":"Save",children:"Save"}),r.jsx("button",{type:"button",onClick:()=>e6(t.id),className:"inline-flex items-center gap-1.5 min-h-[2rem] px-2 py-1 rounded-lg text-sm font-medium text-gray-700 bg-gray-200 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-gray-400 cursor-pointer",title:"Cancel editing","aria-label":"Cancel",children:"Cancel"})]}):r.jsx("button",{type:"button",onClick:()=>en(t.id),className:"p-1.5 rounded text-dhl-red hover:bg-dhl-yellow/25 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-dhl-red",title:"Edit status, lifecycle, owner (owner only)","aria-label":"Edit",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[r.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),r.jsx("path",{d:"m15 5 4 4"})]})})),u?r.jsx(d.default,{href:`/products/${t.id}`,className:"inline-flex p-1.5 rounded text-dhl-red hover:bg-dhl-yellow/25 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-dhl-red",title:"Edit product","aria-label":"Edit product",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[r.jsx("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}),r.jsx("path",{d:"m15 5 4 4"})]})}):r.jsx(d.default,{href:`/products/${t.id}`,className:"text-blue-600 hover:underline text-sm",children:"View"})]})})]},t.id)})]}),(0,r.jsxs)("tbody",{children:[eL.length>0&&eP.length>0&&r.jsx("tr",{children:r.jsx("td",{colSpan:8,className:"px-4 py-2 text-sm font-semibold text-gray-700 border-b border-slate-200 bg-slate-50/50",children:"Products"})}),eP.map((t,s)=>{let a=ef?eS.get(t.id):null,l=ed[t.id],n=l?.status??t.status,i=l?.lifecycle_status??t.lifecycle_status,o=l?.owner_id!==void 0?l.owner_id??"none":t.owner_id??"none",c=el===t.id,u=!!(e?.id&&(t.owner_id===e.id||ef)),h=u&&(ei===t.id||c),p=eL.length+s+1,m=eV.isDependent.has(t.id),x=eV.hasDependency.has(t.id),g=eV.relatedSerialsByProductId.get(t.id)??[];return(0,r.jsxs)("tr",{className:`group/row border-b last:border-0 ${u?"cursor-pointer hover:bg-dhl-yellow/10":"hover:bg-slate-50/50"} ${ez(p)} ${eK?.has(p)?"ring-2 ring-amber-400 ring-inset bg-amber-50/70":""} ${ei===t.id?"bg-dhl-yellow/15":""}`,onMouseLeave:()=>e5(t),onClick:()=>u&&!c&&eo(e=>e===t.id?null:t.id),children:[r.jsx("td",{className:"px-4 py-3 w-10"}),r.jsx("td",{className:"px-4 py-3 text-gray-500 tabular-nums w-12",children:p}),r.jsx("td",{className:"px-4 py-3",children:(0,r.jsxs)("span",{className:`flex items-center gap-1.5 ${m?"font-bold italic text-red-600":""}`,children:[a&&(ef?r.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),e1(t.id,a.id,t.name)},className:"text-amber-600 hover:text-amber-800 shrink-0 p-0.5 rounded focus:outline-none focus:ring-2 focus:ring-amber-500",title:"Confirm or reject deletion request","aria-label":"Confirm deletion request",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),r.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),r.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),r.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})}):r.jsx("span",{className:"text-amber-600 shrink-0",title:"Pending deletion request","aria-label":"Pending deletion request",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("path",{d:"M3 6h18"}),r.jsx("path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"}),r.jsx("path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"}),r.jsx("line",{x1:"10",y1:"11",x2:"10",y2:"17"}),r.jsx("line",{x1:"14",y1:"11",x2:"14",y2:"17"})]})})),r.jsx(d.default,{href:`/products/${t.id}`,className:"font-medium text-indigo-600 hover:text-indigo-700 hover:underline focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-1 rounded",children:t.name}),m&&r.jsx("span",{className:"text-red-600 font-bold ml-0.5","aria-label":"Dependent product",children:"*"}),x&&r.jsx("span",{className:"text-blue-600 font-bold ml-0.5","aria-label":"Has dependency",children:"*"}),(m||x)&&g.length>0&&(0,r.jsxs)("sup",{className:"text-slate-500 font-normal ml-0.5 cursor-pointer rounded px-0.5 hover:bg-amber-100 hover:text-amber-800",title:"Dependency row numbers — hover or click to highlight rows",role:"button",tabIndex:0,onMouseEnter:()=>{eQ(new Set(g)),eB(!1)},onMouseLeave:()=>{eI||eQ(null)},onClick:e=>{e.preventDefault(),e.stopPropagation();let t=eK&&g.length===eK.size&&g.every(e=>eK.has(e));eI&&t?(eQ(null),eB(!1)):(eQ(new Set(g)),eB(!0))},onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),e.target.click())},children:["(",g.join(", "),")"]})]})}),r.jsx("td",{className:"px-4 py-3",children:t.version||"—"}),r.jsx("td",{className:"px-4 py-3",children:u&&c?(0,r.jsxs)("select",{value:y(n),onChange:e=>{let s=e.target.value;ec(e=>({...e,[t.id]:{...e[t.id],status:s}}))},className:"input py-1 text-sm w-auto min-w-[100px]",disabled:e0.isPending,title:"Set product status (owner)",children:[r.jsx("option",{value:"pending",children:"Pending"}),r.jsx("option",{value:"approved",children:"Approved"}),r.jsx("option",{value:"archived",children:"Archived"})]}):r.jsx("span",{className:"px-2 py-0.5 rounded text-sm bg-dhl-yellow/30 text-slate-800",children:b(n)})}),r.jsx("td",{className:"px-4 py-3",children:u&&c?(0,r.jsxs)("select",{value:i,onChange:e=>{let s=e.target.value;ec(e=>({...e,[t.id]:{...e[t.id],lifecycle_status:s}}))},className:"input py-1 text-sm w-auto min-w-[120px]",disabled:e0.isPending,title:"Set lifecycle (owner)",children:[r.jsx("option",{value:"active",children:"Active"}),r.jsx("option",{value:"not_active",children:"Not Active"}),r.jsx("option",{value:"suspend",children:"Suspend"}),r.jsx("option",{value:"end_of_roadmap",children:"End of roadmap"})]}):r.jsx("span",{className:(l?.lifecycle_status??t.lifecycle_status)==="active"?"text-green-600 text-sm":(l?.lifecycle_status??t.lifecycle_status)==="not_active"?"text-gray-600 text-sm":(l?.lifecycle_status??t.lifecycle_status)==="suspend"?"text-amber-600 text-sm":"text-gray-600 text-sm",children:"active"===i?"Active":"not_active"===i?"Not Active":"suspend"===i?"Suspend":"end_of_roadmap"===i?"End of roadmap":i})}),r.jsx("td",{className:"px-4 py-3",children:u&&c?r.jsx("div",{children:(0,r.jsxs)("select",{value:o,onChange:e=>{let s=e.target.value;ec(e=>({...e,[t.id]:{...e[t.id],owner_id:"none"===s?null:s}}))},className:"input py-1 text-sm w-auto min-w-[120px]",disabled:e0.isPending,title:"Set owner (owner)",children:[r.jsx("option",{value:"none",children:"No owner"}),eC.map(e=>(0,r.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})}):t.owner?.name??"—"}),r.jsx("td",{className:`px-4 py-3 align-middle transition-opacity ${ei===t.id||c?"opacity-100":"opacity-0 group-hover/row:opacity-100"}`,onClick:e=>e.stopPropagation(),children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[h&&(c?(0,r.jsxs)(r.Fragment,{children:[r.jsx("button",{type:"button",onClick:()=>e3(t),className:"inline-flex items-center gap-1.5 min-h-[2rem] px-2 py-1 rounded-lg text-sm font-medium text-white bg-dhl-red hover:opacity-90 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-dhl-yellow cursor-pointer",title:"Save changes","aria-label":"Save",children:"Save"}),r.jsx("button",{type:"button",onClick:()=>e6(t.id),className:"inline-flex items-center gap-1.5 min-h-[2rem] px-2 py-1 rounded-lg text-sm font-medium text-gray-700 bg-gray-200 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-gray-400 cursor-pointer",title:"Cancel editing","aria-label":"Cancel",children:"Cancel"})]}):r.jsx("button",{type:"button",onClick:()=>en(t.id),className:"p-1.5 rounded text-dhl-red hover:bg-dhl-yellow/25 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-dhl-red",title:"Edit status, lifecycle, owner (owner only)","aria-label":"Edit",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[r.jsx("path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z"}),r.jsx("path",{d:"m15 5 4 4"})]})})),u?r.jsx(d.default,{href:`/products/${t.id}`,className:"inline-flex p-1.5 rounded text-dhl-red hover:bg-dhl-yellow/25 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-dhl-red",title:"Edit product","aria-label":"Edit product",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round","aria-hidden":"true",children:[r.jsx("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"}),r.jsx("path",{d:"m15 5 4 4"})]})}):r.jsx(d.default,{href:`/products/${t.id}`,className:"text-blue-600 hover:underline text-sm",children:"View"})]})})]},t.id)})]})]})}),ew&&(0,r.jsxs)("div",{className:"flex flex-wrap justify-between items-center gap-3 px-4 py-3 border-t bg-gray-50",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-4",children:[r.jsx("span",{className:"text-sm text-gray-600",children:0===ew.total?"No products":`${ew.offset+1}–${Math.min(ew.offset+ew.items.length,ew.total)} of ${ew.total}`}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[r.jsx("label",{htmlFor:"products-page-size",className:"text-sm text-gray-600 whitespace-nowrap",children:"Rows per page:"}),(0,r.jsxs)("select",{id:"products-page-size",value:String(ev),onChange:e=>{let t=e.target.value;"custom"===t?(w(ey in x?25:ey),_(String(ey))):(w(Number(t)),_(""),v(0))},className:"rounded border border-slate-200 px-2 py-1.5 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400","aria-label":"Rows per page",children:[x.map(e=>r.jsx("option",{value:e,children:e},e)),r.jsx("option",{value:"custom",children:"Custom"})]}),"custom"===ev&&r.jsx("input",{type:"number",min:1,max:200,value:N,onChange:e=>{let t=e.target.value;_(t);let s=parseInt(t,10);Number.isNaN(s)||(w(Math.min(200,Math.max(1,s))),v(0))},onBlur:()=>{if(""===N||Number.isNaN(parseInt(N,10)))_(String(ey));else{let e=Math.min(200,Math.max(1,parseInt(N,10)));_(String(e)),w(e)}},className:"w-16 rounded border border-slate-200 px-2 py-1.5 text-sm focus:ring-2 focus:ring-slate-400 focus:border-slate-400",placeholder:`1–200`,"aria-label":"Custom rows per page (max 200)"})]})]}),ew.total>ey&&(0,r.jsxs)("div",{className:"flex gap-2",children:[r.jsx("button",{type:"button",disabled:0===ew.offset,onClick:()=>v(e=>Math.max(0,e-ey)),className:"btn-secondary text-sm disabled:opacity-50",children:"Previous"}),r.jsx("button",{type:"button",disabled:ew.offset+ew.items.length>=ew.total,onClick:()=>v(e=>e+ey),className:"btn-secondary text-sm disabled:opacity-50",children:"Next"})]})]})]}),ef&&eu&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-edit-title",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[r.jsx("h2",{id:"confirm-edit-title",className:"text-lg font-semibold text-gray-900 mb-2",children:"Confirm changes"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm mb-4",children:["To apply your changes, type the ",r.jsx("strong",{children:"product name"})," and ",r.jsx("strong",{children:"version"})," exactly as shown below. This action is logged in the audit log."]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-3 bg-gray-50 px-3 py-2 rounded border border-gray-200",children:["Product: ",r.jsx("strong",{children:eu.product.name||"—"}),null!=eu.product.version&&""!==eu.product.version&&(0,r.jsxs)(r.Fragment,{children:[" \xb7 Version: ",r.jsx("strong",{children:eu.product.version})]}),(null==eu.product.version||""===eu.product.version)&&(0,r.jsxs)(r.Fragment,{children:[" \xb7 Version: ",r.jsx("strong",{children:"(leave empty if none)"})]})]}),r.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Product name"}),r.jsx("input",{type:"text",value:ep,onChange:e=>em(e.target.value),className:"input mb-4",placeholder:eu.product.name?`e.g. ${eu.product.name}`:"Type the product name","aria-label":"Product name",autoComplete:"off"}),r.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-1",children:"Version"}),r.jsx("input",{type:"text",value:ex,onChange:e=>eg(e.target.value),className:"input mb-4",placeholder:eu.product.version?`e.g. ${eu.product.version}`:"Leave empty if no version","aria-label":"Version",autoComplete:"off"}),e0.isError&&(0,r.jsxs)("div",{className:"mb-4 p-3 rounded-lg bg-red-50 border border-red-200",role:"alert",children:[r.jsx("p",{className:"text-red-700 text-sm font-medium",children:e0.error?.message??"Update failed"}),(e0.error?.message==="Bad Request"||!e0.error?.message)&&r.jsx("p",{className:"text-red-600 text-xs mt-2",children:'Common causes: use a valid user as Owner (or "No owner" to clear).'}),r.jsx("p",{className:"text-red-600 text-xs mt-1",children:"Fix the issue above or cancel. The modal stays open so you can correct and try again."})]}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{type:"button",onClick:e4,className:"btn-secondary",children:"Cancel"}),r.jsx("button",{type:"button",onClick:()=>{if(!eu)return;let{product:e,pending:t}=eu,s=ep.trim()===(e.name||"").trim(),r=ex.trim()===(e.version||"").trim();s&&r&&e0.mutate({id:e.id,pending:t})},disabled:!e8||e0.isPending,className:"btn-primary disabled:opacity-50",children:e0.isPending?"Applying…":"Apply"})]})]})}),ef&&Y&&X&&r.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",role:"dialog","aria-modal":"true","aria-labelledby":"confirm-deletion-title",children:(0,r.jsxs)("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full p-6",children:[r.jsx("h2",{id:"confirm-deletion-title",className:"text-lg font-semibold text-gray-900 mb-2",children:"Confirm deletion request"}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm mb-4",children:["This will ",r.jsx("strong",{children:"archive"})," the product (status set to Archived). The product and its data will remain but will be marked as archived. This action requires double confirmation."]}),(0,r.jsxs)("p",{className:"text-gray-600 text-sm mb-2",children:["Type the exact ",r.jsx("strong",{children:"product name"})," below to confirm:"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-500 mb-3 bg-gray-50 px-3 py-2 rounded border border-gray-200",children:["Product: ",r.jsx("strong",{children:et||"—"})]}),r.jsx("input",{type:"text",value:er,onChange:e=>ea(e.target.value),className:"input mb-4",placeholder:et?`e.g. ${et}`:"Type the product name","aria-label":"Product name",autoComplete:"off"}),(0,r.jsxs)("div",{className:"flex gap-2 justify-end",children:[r.jsx("button",{type:"button",onClick:()=>{J(null),ee(null),es(""),ea("")},className:"btn-secondary",children:"Cancel"}),r.jsx("button",{type:"button",onClick:()=>{X&&er.trim()===(et||"").trim()&&e2.mutate({id:X,approved:!0})},disabled:er.trim()!==(et||"").trim()||e2.isPending,className:"btn-primary bg-amber-600 hover:bg-amber-700 disabled:opacity-50",children:e2.isPending?"Archiving…":"Confirm and archive"})]}),e2.isError&&r.jsx("p",{className:"text-red-600 text-sm mt-2",role:"alert",children:e2.error?.message})]})})]})}function j(){return r.jsx(u.Y,{children:r.jsx(v,{})})}},2643:(e,t,s)=>{"use strict";s.d(t,{Y:()=>n});var r=s(326);s(7577);var a=s(5047),l=s(6591);function n({children:e}){let t=(0,l.t)(e=>e.user);return((0,a.useRouter)(),t)?r.jsx(r.Fragment,{children:e}):r.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:r.jsx("p",{className:"text-gray-500",children:"Redirecting to login..."})})}},104:(e,t,s)=>{"use strict";s.d(t,{IO:()=>a,Z$:()=>i,e6:()=>l,tq:()=>n});let r=e=>e.toISOString().slice(0,10);function a(e,t,s){if("all"===e)return{dateFrom:"",dateTo:""};let a=new Date;if(a.setHours(0,0,0,0),"custom"===e&&null!=t&&null!=s)return{dateFrom:t,dateTo:s};let l=(e,t)=>{let s=new Date(e);return s.setDate(s.getDate()+t),s},n=l(a,-1);switch(e){case"yesterday":return{dateFrom:r(n),dateTo:r(n)};case"today":return{dateFrom:r(a),dateTo:r(a)};case"last_2_days":default:return{dateFrom:r(n),dateTo:r(a)};case"last_3_days":return{dateFrom:r(l(a,-2)),dateTo:r(a)};case"last_week":return{dateFrom:r(l(a,-6)),dateTo:r(a)};case"last_month":return{dateFrom:r(l(a,-29)),dateTo:r(a)};case"last_quarter":return{dateFrom:r(l(a,-89)),dateTo:r(a)};case"last_half_year":return{dateFrom:r(l(a,-181)),dateTo:r(a)};case"last_year":return{dateFrom:r(l(a,-364)),dateTo:r(a)}}}function l(){return a("last_2_days")}let n=[{value:"yesterday",label:"Yesterday"},{value:"today",label:"Today"},{value:"last_2_days",label:"Last 2 days"},{value:"last_3_days",label:"Last 3 days"},{value:"last_week",label:"Last week"},{value:"last_month",label:"Last month"},{value:"last_quarter",label:"Last quarter"},{value:"last_half_year",label:"Last half year"},{value:"last_year",label:"Last year"},{value:"custom",label:"Custom"}],i=[{value:"all",label:"All time"},...n]},7338:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>n,__esModule:()=>l,default:()=>i});var r=s(8570);let a=(0,r.createProxy)(String.raw`/home/manojmenon/projects/rm/frontend/src/app/products/page.tsx`),{__esModule:l,$$typeof:n}=a;a.default;let i=(0,r.createProxy)(String.raw`/home/manojmenon/projects/rm/frontend/src/app/products/page.tsx#default`)},119:(e,t,s)=>{"use strict";s.d(t,{D:()=>c});var r=s(7577),a=s(1180),l=s(2113),n=s(4351),i=s(3341),o=class extends n.l{#e;#t=void 0;#s;#r;constructor(e,t){super(),this.#e=e,this.setOptions(t),this.bindMethods(),this.#a()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){let t=this.options;this.options=this.#e.defaultMutationOptions(e),(0,i.VS)(this.options,t)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#s,observer:this}),t?.mutationKey&&this.options.mutationKey&&(0,i.Ym)(t.mutationKey)!==(0,i.Ym)(this.options.mutationKey)?this.reset():this.#s?.state.status==="pending"&&this.#s.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#s?.removeObserver(this)}onMutationUpdate(e){this.#a(),this.#l(e)}getCurrentResult(){return this.#t}reset(){this.#s?.removeObserver(this),this.#s=void 0,this.#a(),this.#l()}mutate(e,t){return this.#r=t,this.#s?.removeObserver(this),this.#s=this.#e.getMutationCache().build(this.#e,this.options),this.#s.addObserver(this),this.#s.execute(e)}#a(){let e=this.#s?.state??(0,a.R)();this.#t={...e,isPending:"pending"===e.status,isSuccess:"success"===e.status,isError:"error"===e.status,isIdle:"idle"===e.status,mutate:this.mutate,reset:this.reset}}#l(e){l.Vr.batch(()=>{if(this.#r&&this.hasListeners()){let t=this.#t.variables,s=this.#t.context,r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#r.onSuccess?.(e.data,t,s,r)}catch(e){Promise.reject(e)}try{this.#r.onSettled?.(e.data,null,t,s,r)}catch(e){Promise.reject(e)}}else if(e?.type==="error"){try{this.#r.onError?.(e.error,t,s,r)}catch(e){Promise.reject(e)}try{this.#r.onSettled?.(void 0,e.error,t,s,r)}catch(e){Promise.reject(e)}}}this.listeners.forEach(e=>{e(this.#t)})})}},d=s(4976);function c(e,t){let s=(0,d.NL)(t),[a]=r.useState(()=>new o(s,e));r.useEffect(()=>{a.setOptions(e)},[a,e]);let n=r.useSyncExternalStore(r.useCallback(e=>a.subscribe(l.Vr.batchCalls(e)),[a]),()=>a.getCurrentResult(),()=>a.getCurrentResult()),c=r.useCallback((e,t)=>{a.mutate(e,t).catch(i.ZT)},[a]);if(n.error&&(0,i.L3)(a.options.throwOnError,[n.error]))throw n.error;return{...n,mutate:c,mutateAsync:n.mutate}}},6324:(e,t,s)=>{"use strict";s.d(t,{h:()=>x});var r=s(7577),a=s(2113),l=s(7293),n=s(4351),i=s(3341);function o(e,t){let s=new Set(t);return e.filter(e=>!s.has(e))}var d=class extends n.l{#e;#n;#i;#o;#d;#c;#u;#h;#p;#m=[];constructor(e,t,s){super(),this.#e=e,this.#o=s,this.#i=[],this.#d=[],this.#n=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#d.forEach(e=>{e.subscribe(t=>{this.#x(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#d.forEach(e=>{e.destroy()})}setQueries(e,t){this.#i=e,this.#o=t,a.Vr.batch(()=>{let e=this.#d,t=this.#g(this.#i);t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let s=t.map(e=>e.observer),r=s.map(e=>e.getCurrentResult()),a=e.length!==s.length,l=s.some((t,s)=>t!==e[s]),n=a||l,d=!!n||r.some((e,t)=>{let s=this.#n[t];return!s||!(0,i.VS)(e,s)});(n||d)&&(n&&(this.#m=t,this.#d=s),this.#n=r,this.hasListeners()&&(n&&(o(e,s).forEach(e=>{e.destroy()}),o(s,e).forEach(e=>{e.subscribe(t=>{this.#x(e,t)})})),this.#l()))})}getCurrentResult(){return this.#n}getQueries(){return this.#d.map(e=>e.getCurrentQuery())}getObservers(){return this.#d}getOptimisticResult(e,t){let s=this.#g(e),r=s.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions)),a=s.map(e=>e.defaultedQueryOptions.queryHash);return[r,e=>this.#f(e??r,t,a),()=>this.#b(r,s)]}#b(e,t){return t.map((s,r)=>{let a=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?a:s.observer.trackResult(a,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#f(e,t,s){if(t){let r=this.#p,a=void 0!==s&&void 0!==r&&(r.length!==s.length||s.some((e,t)=>e!==r[t]));return(!this.#c||this.#n!==this.#h||a||t!==this.#u)&&(this.#u=t,this.#h=this.#n,void 0!==s&&(this.#p=s),this.#c=(0,i.Q$)(this.#c,t(e))),this.#c}return e}#g(e){let t=new Map;this.#d.forEach(e=>{let s=e.options.queryHash;if(!s)return;let r=t.get(s);r?r.push(e):t.set(s,[e])});let s=[];return e.forEach(e=>{let r=this.#e.defaultQueryOptions(e),a=t.get(r.queryHash)?.shift()??new l.z(this.#e,r);s.push({defaultedQueryOptions:r,observer:a})}),s}#x(e,t){let s=this.#d.indexOf(e);-1!==s&&(this.#n=function(e,t,s){let r=e.slice(0);return r[t]=s,r}(this.#n,s,t),this.#l())}#l(){if(this.hasListeners()){let e=this.#c,t=this.#b(this.#n,this.#m);e!==this.#f(t,this.#o?.combine)&&a.Vr.batch(()=>{this.listeners.forEach(e=>{e(this.#n)})})}}},c=s(4976),u=s(2353),h=s(3550),p=s(3875),m=s(4138);function x({queries:e,...t},s){let n=(0,c.NL)(s),o=(0,u.S)(),x=(0,h._)(),g=r.useMemo(()=>e.map(e=>{let t=n.defaultQueryOptions(e);return t._optimisticResults=o?"isRestoring":"optimistic",t}),[e,n,o]);g.forEach(e=>{(0,m.A8)(e);let t=n.getQueryCache().get(e.queryHash);(0,p.pf)(e,x,t)}),(0,p.JN)(x);let[f]=r.useState(()=>new d(n,g,t)),[b,y,v]=f.getOptimisticResult(g,t.combine),j=!o&&!1!==t.subscribed;r.useSyncExternalStore(r.useCallback(e=>j?f.subscribe(a.Vr.batchCalls(e)):i.ZT,[f,j]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),r.useEffect(()=>{f.setQueries(g,t)},[g,t,f]);let w=b.some((e,t)=>(0,m.SB)(g[t],e))?b.flatMap((e,t)=>{let s=g[t];if(s){let t=new l.z(n,s);if((0,m.SB)(s,e))return(0,m.j8)(s,t,x);(0,m.Z$)(e,o)&&(0,m.j8)(s,t,x)}return[]}):[];if(w.length>0)throw Promise.all(w);let N=b.find((e,t)=>{let s=g[t];return s&&(0,p.KJ)({result:e,errorResetBoundary:x,throwOnError:s.throwOnError,query:n.getQueryCache().get(s.queryHash),suspense:s.suspense})});if(N?.error)throw N.error;return y(v())}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,192,457],()=>s(1179));module.exports=r})();