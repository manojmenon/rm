(()=>{var e={};e.id=702,e.ids=[702],e.modules={7849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},5403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},4749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5239:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>i.a,__next_app__:()=>h,originalPathname:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>o}),s(8256),s(9127),s(5866);var r=s(3191),a=s(8716),l=s(7922),i=s.n(l),d=s(5231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);s.d(t,n);let o=["",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,8256)),"/home/manojmenon/projects/rm/frontend/src/app/dashboard/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,9127)),"/home/manojmenon/projects/rm/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/home/manojmenon/projects/rm/frontend/src/app/dashboard/page.tsx"],u="/dashboard/page",h={require:s,loadChunk:()=>Promise.resolve()},m=new r.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/page",pathname:"/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},3142:(e,t,s)=>{Promise.resolve().then(s.bind(s,9530))},9530:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>x});var r=s(326),a=s(7577),l=s(6667),i=s(6324),d=s(434),n=s(2643),o=s(8069),c=s(6591),u=s(6261);function h(){let e=(0,c.t)(e=>e.user),t=(()=>{let t=e?.role?.toLowerCase();return"admin"===t||"superadmin"===t})(),[s,i]=(0,a.useState)(!1),[n,h]=(0,a.useState)(""),x=function(){let e=e=>o.h.products.list({...e,limit:1,offset:0}),t=(0,l.a)({queryKey:["products",{limit:1}],queryFn:()=>e({}),staleTime:6e4}),s=(0,l.a)({queryKey:["products",{lifecycle_status:"active"}],queryFn:()=>e({lifecycle_status:"active"}),staleTime:6e4}),r=(0,l.a)({queryKey:["products",{lifecycle_status:"not_active"}],queryFn:()=>e({lifecycle_status:"not_active"}),staleTime:6e4}),a=(0,l.a)({queryKey:["products",{lifecycle_status:"suspend"}],queryFn:()=>e({lifecycle_status:"suspend"}),staleTime:6e4}),i=(0,l.a)({queryKey:["products",{lifecycle_status:"end_of_roadmap"}],queryFn:()=>e({lifecycle_status:"end_of_roadmap"}),staleTime:6e4});return{total:t.data?.total??0,active:s.data?.total??0,notActive:r.data?.total??0,suspend:a.data?.total??0,endOfRoadmap:i.data?.total??0,loadingTotal:t.isLoading}}(),[p,f]=(0,a.useState)(!1),y=function(e,t){let s={owner_id:e??"",limit:1,offset:0},r=!!e&&t,a=(0,l.a)({queryKey:["products",{...s}],queryFn:()=>o.h.products.list(s),enabled:r,staleTime:6e4}),i=(0,l.a)({queryKey:["products",{...s,lifecycle_status:"active"}],queryFn:()=>o.h.products.list({...s,lifecycle_status:"active"}),enabled:r,staleTime:6e4}),d=(0,l.a)({queryKey:["products",{...s,status:"archived"}],queryFn:()=>o.h.products.list({...s,status:"archived"}),enabled:r,staleTime:6e4}),n=(0,l.a)({queryKey:["products",{...s,lifecycle_status:"not_active"}],queryFn:()=>o.h.products.list({...s,lifecycle_status:"not_active"}),enabled:r,staleTime:6e4}),c=(0,l.a)({queryKey:["products",{...s,lifecycle_status:"suspend"}],queryFn:()=>o.h.products.list({...s,lifecycle_status:"suspend"}),enabled:r,staleTime:6e4}),u=(0,l.a)({queryKey:["products",{...s,lifecycle_status:"end_of_roadmap"}],queryFn:()=>o.h.products.list({...s,lifecycle_status:"end_of_roadmap"}),enabled:r,staleTime:6e4});return{myTotal:a.data?.total??0,active:i.data?.total??0,archived:d.data?.total??0,notActive:n.data?.total??0,suspend:c.data?.total??0,endOfRoadmap:u.data?.total??0}}(e?.id,p),{data:b=[],isLoading:j}=(0,l.a)({queryKey:["users"],queryFn:()=>o.h.users.list(),enabled:t&&p,staleTime:6e4}),g=(0,a.useMemo)(()=>{if(!n.trim())return b;let e=n.trim().toLowerCase();return b.filter(t=>t.name.toLowerCase().includes(e)||(t.email??"").toLowerCase().includes(e))},[b,n]),[v,N]=(0,a.useState)(!1),{data:_}=(0,l.a)({queryKey:["product-requests"],queryFn:()=>o.h.requests.list(),enabled:p,staleTime:6e4}),{data:w}=(0,l.a)({queryKey:["deletion-requests"],queryFn:()=>o.h.deletionRequests.list(),enabled:t&&p,staleTime:6e4}),{data:q}=(0,l.a)({queryKey:["products",{status:"pending",limit:1}],queryFn:()=>o.h.products.list({status:"pending",limit:1,offset:0}),enabled:p,staleTime:6e4}),R=q?.total??0,T=(0,u.eI)(_,w)+R,F=e?.id?`/products?owner_id=${encodeURIComponent(e.id)}`:"/products";return(0,r.jsxs)("div",{className:"min-h-[60vh] flex flex-col items-center px-4 pb-10",children:[r.jsx("h1",{className:"text-2xl font-bold text-slate-800 tracking-tight mb-6",children:"Dashboard"}),(0,r.jsxs)("div",{className:"w-full max-w-5xl space-y-6",children:[r.jsx("div",{className:"rounded-xl border-2 border-dhl-red/30 bg-white shadow-sm overflow-hidden",children:(0,r.jsxs)("table",{className:"w-full min-w-[520px]",children:[r.jsx("thead",{className:"bg-dhl-yellow/25 border-b-2 border-dhl-red/40",children:(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"text-left px-4 py-3 font-medium text-dhl-red",children:"Scope"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"Total"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"Active"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"Not active"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"Suspended"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"End of roadmap"})]})}),(0,r.jsxs)("tbody",{className:"divide-y divide-dhl-red/20",children:[(0,r.jsxs)("tr",{className:"hover:bg-dhl-yellow/10",children:[r.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-800",children:"Global"}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:"/products",className:"text-dhl-red hover:underline font-medium tabular-nums",children:x.loadingTotal?"—":x.total})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:"/products?lifecycle_status=active",className:"text-dhl-red hover:underline tabular-nums",children:x.active})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:"/products?lifecycle_status=not_active",className:"text-dhl-red hover:underline tabular-nums",children:x.notActive})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:"/products?lifecycle_status=suspend",className:"text-dhl-red hover:underline tabular-nums",children:x.suspend})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:"/products?lifecycle_status=end_of_roadmap",className:"text-dhl-red hover:underline tabular-nums",children:x.endOfRoadmap})})]}),(0,r.jsxs)("tr",{className:"hover:bg-dhl-yellow/10 bg-dhl-yellow/15",children:[r.jsx("td",{className:"px-4 py-3 text-sm font-medium text-slate-800",children:"My products"}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:F,className:"text-dhl-red hover:underline font-medium tabular-nums",children:y.myTotal})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:`${F}&lifecycle_status=active`,className:"text-dhl-red hover:underline tabular-nums",children:y.active})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:`${F}&lifecycle_status=not_active`,className:"text-dhl-red hover:underline tabular-nums",children:y.notActive})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:`${F}&lifecycle_status=suspend`,className:"text-dhl-red hover:underline tabular-nums",children:y.suspend})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:`${F}&lifecycle_status=end_of_roadmap`,className:"text-dhl-red hover:underline tabular-nums",children:y.endOfRoadmap})})]})]})]})}),t&&(0,r.jsxs)("div",{className:"rounded-xl border-2 border-dhl-red/30 bg-white shadow-sm overflow-hidden",children:[(0,r.jsxs)("div",{className:"px-4 py-3 border-b-2 border-dhl-red/40 bg-dhl-yellow/25 flex items-center justify-between",children:[r.jsx("h2",{className:"text-sm font-semibold text-dhl-red uppercase tracking-wide",children:"Per user (admin)"}),T>0&&(0,r.jsxs)("span",{className:"text-amber-700 text-sm font-medium",children:["Pending: ",T]})]}),r.jsx("div",{className:"overflow-x-auto",children:(0,r.jsxs)("table",{className:"w-full min-w-[640px]",children:[(0,r.jsxs)("thead",{className:"bg-dhl-yellow/25 border-b-2 border-dhl-red/40",children:[(0,r.jsxs)("tr",{children:[r.jsx("th",{className:"text-left px-4 py-3 w-12",children:r.jsx("button",{type:"button",onClick:()=>i(e=>!e),className:`p-1.5 rounded transition-colors ${s?"bg-dhl-yellow text-dhl-red":"text-gray-500 hover:bg-gray-200 hover:text-gray-700"}`,"aria-label":s?"Hide table filters":"Show table filters",title:s?"Hide filters":"Filter table",children:(0,r.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[r.jsx("circle",{cx:"11",cy:"11",r:"8"}),r.jsx("path",{d:"m21 21-4.35-4.35"})]})})}),r.jsx("th",{className:"text-left px-4 py-3 font-medium text-dhl-red w-12",children:"#"}),r.jsx("th",{className:"text-left px-4 py-3 font-medium text-dhl-red",children:"User"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"Total"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"I own"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"Archived"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"Not active"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"Suspended"}),r.jsx("th",{className:"text-right px-4 py-3 font-medium text-dhl-red",children:"End of roadmap"})]}),s&&(0,r.jsxs)("tr",{className:"bg-dhl-yellow/15 border-b border-dhl-red/30",children:[r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2",children:r.jsx("input",{type:"text",value:n,onChange:e=>h(e.target.value),placeholder:"Filter by user name or email…",className:"w-full rounded border border-dhl-red/40 px-2 py-1.5 text-sm focus:ring-2 focus:ring-dhl-red focus:border-dhl-red","aria-label":"Filter by user"})}),r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2"}),r.jsx("th",{className:"px-4 py-2"})]})]}),r.jsx("tbody",{className:"divide-y divide-dhl-red/20",children:j?r.jsx("tr",{children:r.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-slate-500 text-sm",children:"Loading users…"})}):0===g.length?r.jsx("tr",{children:r.jsx("td",{colSpan:9,className:"px-4 py-8 text-center text-slate-500 text-sm",children:0===b.length?"No users.":"No users match the filter."})}):g.map((e,t)=>r.jsx(m,{user:e,index:t,enableStats:v||t<8},e.id))})]})})]})]})]})}function m({user:e,index:t,enableStats:s}){let a=(0,i.h)({queries:[{queryKey:["products",{owner_id:e.id,limit:1}],queryFn:()=>o.h.products.list({owner_id:e.id,limit:1,offset:0}),staleTime:6e4,enabled:s},{queryKey:["products",{owner_id:e.id,status:"archived",limit:1}],queryFn:()=>o.h.products.list({owner_id:e.id,status:"archived",limit:1,offset:0}),staleTime:6e4,enabled:s},{queryKey:["products",{owner_id:e.id,lifecycle_status:"not_active",limit:1}],queryFn:()=>o.h.products.list({owner_id:e.id,lifecycle_status:"not_active",limit:1,offset:0}),staleTime:6e4,enabled:s},{queryKey:["products",{owner_id:e.id,lifecycle_status:"suspend",limit:1}],queryFn:()=>o.h.products.list({owner_id:e.id,lifecycle_status:"suspend",limit:1,offset:0}),staleTime:6e4,enabled:s},{queryKey:["products",{owner_id:e.id,lifecycle_status:"end_of_roadmap",limit:1}],queryFn:()=>o.h.products.list({owner_id:e.id,lifecycle_status:"end_of_roadmap",limit:1,offset:0}),staleTime:6e4,enabled:s}]}),l=a[0]?.data?.total??0,n=a[1]?.data?.total??0,c=a[2]?.data?.total??0,u=a[3]?.data?.total??0,h=a[4]?.data?.total??0,m=`/products?owner_id=${encodeURIComponent(e.id)}`;return(0,r.jsxs)("tr",{className:"hover:bg-dhl-yellow/10",children:[r.jsx("td",{className:"px-4 py-3 w-12"}),r.jsx("td",{className:"px-4 py-3 text-slate-500 text-sm tabular-nums w-12",children:t+1}),r.jsx("td",{className:"px-4 py-3",children:r.jsx(d.default,{href:m,className:"text-sm font-medium text-dhl-red hover:text-dhl-red/80 hover:underline",children:e.name})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:m,className:"text-dhl-red hover:underline text-sm tabular-nums",children:l})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:m,className:"text-dhl-red hover:underline text-sm tabular-nums",children:l})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:`${m}&status=archived`,className:"text-dhl-red hover:underline text-sm tabular-nums",children:n})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:`${m}&lifecycle_status=not_active`,className:"text-dhl-red hover:underline text-sm tabular-nums",children:c})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:`${m}&lifecycle_status=suspend`,className:"text-dhl-red hover:underline text-sm tabular-nums",children:u})}),r.jsx("td",{className:"px-4 py-3 text-right",children:r.jsx(d.default,{href:`${m}&lifecycle_status=end_of_roadmap`,className:"text-dhl-red hover:underline text-sm tabular-nums",children:h})})]})}function x(){return r.jsx(n.Y,{children:r.jsx(h,{})})}},2643:(e,t,s)=>{"use strict";s.d(t,{Y:()=>i});var r=s(326);s(7577);var a=s(5047),l=s(6591);function i({children:e}){let t=(0,l.t)(e=>e.user);return((0,a.useRouter)(),t)?r.jsx(r.Fragment,{children:e}):r.jsx("div",{className:"flex items-center justify-center min-h-[40vh]",children:r.jsx("p",{className:"text-gray-500",children:"Redirecting to login..."})})}},8256:(e,t,s)=>{"use strict";s.r(t),s.d(t,{$$typeof:()=>i,__esModule:()=>l,default:()=>d});var r=s(8570);let a=(0,r.createProxy)(String.raw`/home/manojmenon/projects/rm/frontend/src/app/dashboard/page.tsx`),{__esModule:l,$$typeof:i}=a;a.default;let d=(0,r.createProxy)(String.raw`/home/manojmenon/projects/rm/frontend/src/app/dashboard/page.tsx#default`)},6324:(e,t,s)=>{"use strict";s.d(t,{h:()=>p});var r=s(7577),a=s(2113),l=s(7293),i=s(4351),d=s(3341);function n(e,t){let s=new Set(t);return e.filter(e=>!s.has(e))}var o=class extends i.l{#e;#t;#s;#r;#a;#l;#i;#d;#n;#o=[];constructor(e,t,s){super(),this.#e=e,this.#r=s,this.#s=[],this.#a=[],this.#t=[],this.setQueries(t)}onSubscribe(){1===this.listeners.size&&this.#a.forEach(e=>{e.subscribe(t=>{this.#c(e,t)})})}onUnsubscribe(){this.listeners.size||this.destroy()}destroy(){this.listeners=new Set,this.#a.forEach(e=>{e.destroy()})}setQueries(e,t){this.#s=e,this.#r=t,a.Vr.batch(()=>{let e=this.#a,t=this.#u(this.#s);t.forEach(e=>e.observer.setOptions(e.defaultedQueryOptions));let s=t.map(e=>e.observer),r=s.map(e=>e.getCurrentResult()),a=e.length!==s.length,l=s.some((t,s)=>t!==e[s]),i=a||l,o=!!i||r.some((e,t)=>{let s=this.#t[t];return!s||!(0,d.VS)(e,s)});(i||o)&&(i&&(this.#o=t,this.#a=s),this.#t=r,this.hasListeners()&&(i&&(n(e,s).forEach(e=>{e.destroy()}),n(s,e).forEach(e=>{e.subscribe(t=>{this.#c(e,t)})})),this.#h()))})}getCurrentResult(){return this.#t}getQueries(){return this.#a.map(e=>e.getCurrentQuery())}getObservers(){return this.#a}getOptimisticResult(e,t){let s=this.#u(e),r=s.map(e=>e.observer.getOptimisticResult(e.defaultedQueryOptions)),a=s.map(e=>e.defaultedQueryOptions.queryHash);return[r,e=>this.#m(e??r,t,a),()=>this.#x(r,s)]}#x(e,t){return t.map((s,r)=>{let a=e[r];return s.defaultedQueryOptions.notifyOnChangeProps?a:s.observer.trackResult(a,e=>{t.forEach(t=>{t.observer.trackProp(e)})})})}#m(e,t,s){if(t){let r=this.#n,a=void 0!==s&&void 0!==r&&(r.length!==s.length||s.some((e,t)=>e!==r[t]));return(!this.#l||this.#t!==this.#d||a||t!==this.#i)&&(this.#i=t,this.#d=this.#t,void 0!==s&&(this.#n=s),this.#l=(0,d.Q$)(this.#l,t(e))),this.#l}return e}#u(e){let t=new Map;this.#a.forEach(e=>{let s=e.options.queryHash;if(!s)return;let r=t.get(s);r?r.push(e):t.set(s,[e])});let s=[];return e.forEach(e=>{let r=this.#e.defaultQueryOptions(e),a=t.get(r.queryHash)?.shift()??new l.z(this.#e,r);s.push({defaultedQueryOptions:r,observer:a})}),s}#c(e,t){let s=this.#a.indexOf(e);-1!==s&&(this.#t=function(e,t,s){let r=e.slice(0);return r[t]=s,r}(this.#t,s,t),this.#h())}#h(){if(this.hasListeners()){let e=this.#l,t=this.#x(this.#t,this.#o);e!==this.#m(t,this.#r?.combine)&&a.Vr.batch(()=>{this.listeners.forEach(e=>{e(this.#t)})})}}},c=s(4976),u=s(2353),h=s(3550),m=s(3875),x=s(4138);function p({queries:e,...t},s){let i=(0,c.NL)(s),n=(0,u.S)(),p=(0,h._)(),f=r.useMemo(()=>e.map(e=>{let t=i.defaultQueryOptions(e);return t._optimisticResults=n?"isRestoring":"optimistic",t}),[e,i,n]);f.forEach(e=>{(0,x.A8)(e);let t=i.getQueryCache().get(e.queryHash);(0,m.pf)(e,p,t)}),(0,m.JN)(p);let[y]=r.useState(()=>new o(i,f,t)),[b,j,g]=y.getOptimisticResult(f,t.combine),v=!n&&!1!==t.subscribed;r.useSyncExternalStore(r.useCallback(e=>v?y.subscribe(a.Vr.batchCalls(e)):d.ZT,[y,v]),()=>y.getCurrentResult(),()=>y.getCurrentResult()),r.useEffect(()=>{y.setQueries(f,t)},[f,t,y]);let N=b.some((e,t)=>(0,x.SB)(f[t],e))?b.flatMap((e,t)=>{let s=f[t];if(s){let t=new l.z(i,s);if((0,x.SB)(s,e))return(0,x.j8)(s,t,p);(0,x.Z$)(e,n)&&(0,x.j8)(s,t,p)}return[]}):[];if(N.length>0)throw Promise.all(N);let _=b.find((e,t)=>{let s=f[t];return s&&(0,m.KJ)({result:e,errorResetBoundary:p,throwOnError:s.throwOnError,query:i.getQueryCache().get(s.queryHash),suspense:s.suspense})});if(_?.error)throw _.error;return j(g())}}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,192,457],()=>s(5239));module.exports=r})();